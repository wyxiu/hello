<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			* {
				margin: 0;
				padding: 0;
			}
			
			#box {
				width: 590px;
				height: 470px;
				border: 1px solid;
				margin: 50px auto;
				position: relative;
				/*overflow: hidden;*/
			}
			
			ul {
				list-style: none;
				position: absolute;
				height: 470px;
				left: 0px;
				top: 0px;
			}
			
			li {
				float: left;
				width: 590px;
				height: 470px;
			}
			
			.points {
				width: 150px;
				height: 30px;
				position: absolute;
				bottom: 0px;
				left: 35px;
			}
			
			.points i {
				width: 6px;
				height: 6px;
				display: inline-block;
				border: 2px solid #fff;
				border-radius: 50%;
				opacity: .8;
				margin: 5px;
			}
			
			.points i.current {
				background: red;
			}
			
			.back,
			.next {
				position: absolute;
				width: 30px;
				height: 50px;
				line-height: 50px;
				text-align: center;
				background: #ccc;
				opacity: .8;
				top: 0px;
				bottom: 0px;
				margin: auto;
			}
			
			.next {
				right: 0px;
			}
		</style>
	</head>

	<body>
		<div id="box">
			<ul id="imgs">
				<li><img src="images/1.jpg" /></li>
				<li><img src="images/2.jpg" /></li>
				<li><img src="images/3.jpg" /></li>
				<li><img src="images/4.jpg" /></li>
			</ul>
			<div class="points">

			</div>
			<div class="back">&lt;</div>
			<div class="next">&gt;</div>
		</div>
		<script src="js/tools.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			//克隆第一张和最后一张图
			var lis = $("li");
			var len = lis.length;
			var lisWidth = lis[0].offsetWidth;
			var first = lis[0].cloneNode(true);
			var last = lis[len - 1].cloneNode(true);
			var currIndex = 1;
			var nextIndex = 2;
			len += 2;
			$("#imgs").appendChild(first); //向最后添加
			$("#imgs").insertBefore(last, lis[0]); //向开始添加
			//设置ul的宽
			css($("#imgs"), {
				width: lisWidth * len + "px",
				left: -lisWidth + "px"
			});
			//生成小圓點
			var html = "";
			for (var i = 0; i < len - 2; i++) {
				html += `<i ${i==0?"class='current'":""}></i>`;
			}
			var points = $("i");
			$(".points")[0].innerHTML = html;

			function move() {
				//console.log("aaa")
				var _left = -nextIndex * lisWidth;
				console.log(_left+"----"+currIndex)
				animate($("#imgs"), {
					left: _left
				}, 200, function() {
					if (nextIndex >= len) { //右还原
						currIndex = 1;
						nextIndex = currIndex + 1;
						$("#imgs").style.left = -lisWidth + "px";
						//console.log($("#imgs").style.left)
					} else if (nextIndex == 1) { //左还原
						currIndex = len - 2;
						nextIndex = currIndex + 1;
						$("#imgs").style.left = -(len - 2) * lisWidth + "px";
					}
				});
				//找出变红的小圆点
				var index = nextIndex - 1;
				if (index >= len - 2)
					index = 0;
				else if (index < 0)
					index = len - 3;
				// 修改小圆点样式
				for (var i = 0; i < len - 2; i++) {
					points[i].className = "";
				}
				points[index].className = "current";

				currIndex = nextIndex;
				nextIndex++;

			}
			var timer = setInterval(move, 2000);
			on($("#box"),"mouseenter",function(){
				clearInterval(timer);
				
			});on($("#box"),"mouseleave",move);
			
			on($(".back")[0],"click",function(){
				
			});
			
		</script>
	</body>

</html>














